package com.swh.project;
import java.io.File;
import java.lang.reflect.Constructor;
import java.net.Socket;

import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.yaml.YAMLFactory;

public class YRead {
	
	private static Ysr ysr = null;
	
	public YRead() throws Exception{
		// TODO Auto-generated constructor stub
		ObjectMapper mapper = new ObjectMapper(new YAMLFactory());
		ysr = mapper.readValue(new File("src/main/resources/name.yml"), Ysr.class);
	}

	public static ISend getSendC() throws Exception {
		Class<?> finedClass = Class.forName(ysr.getSend());
		ISend sender = (ISend) finedClass.newInstance(); // 생성자 호출
		return sender;
	}
	
	public static IReceive getReceiveC() throws Exception {
		Class<?> finedClass = Class.forName(ysr.getReceive());
		IReceive receiver = (IReceive) finedClass.newInstance();
		return receiver;
	}
	
	public static FileReceiver getTypeC(Socket socket, long start) throws Exception {
		Class<?> finedClass = Class.forName(ysr.getReceive());
		Constructor<?> ctor=finedClass.getConstructor(Socket.class, Long.class);
		FileReceiver type = (FileReceiver) ctor.newInstance(socket, start);
		return type;
	}
	
}
